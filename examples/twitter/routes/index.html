{{ define "content" }}
    <div x-data id="content">
        <p
            id="create-tweet-err"
            @fir:create-tweet:error.window="$fir.replace()">
            {{ block "create-tweet-err" . }}
                {{ .fir.Error "create-tweet" }}
            {{ end }}
        </p>

        <div
            @fir:create-tweet:pending.window="console.log('create tweet start')"
            @fir:create-tweet:done.window="console.log('create tweet done')"></div>

        <form
            id="create-tweet"
            method="post"
            action="/?event=create-tweet"
            @submit.prevent="$fir.submit()"
            style="margin-top:1rem;margin-bottom:1rem;">
            <input type="text" name="body" placeholder="a new tweet" />
            <!-- validation error for the name=body set by ctx.FieldError(...) -->
            <!-- $fir.replace replaces the content of the element on which it is invoked -->
            <!-- $fir.replaceEl replaces the element on which it is invoked -->
            <p
                id="body-err"
                @fir:create-tweet:body:error.window="$fir.replace()">
                {{ block "body-err" . }}
                    {{ .fir.Error "create-tweet.body" }}
                {{ end }}
            </p>

            <button type="submit">Submit</button>
        </form>
        <div id="tweets" @fir:create-tweet.window="$fir.appendEl()">
            {{ range .tweets }}
                <!-- block "tweet*" matches the element id of event listeners: 
                @fir:delete-tweet(tweet-{{ .ID }})
                @fir:create-tweet(tweets)
                Similary, block "like-tweet*" matches the element id of event listeners:
                @fir:like-tweet(tweet-{{ .ID }})
                The block is re-rendered on the server aftter the event is emitted by $fir.submit()
                The output html is patched(removeEl,appendEl,replace,) to the element on the client.
               -->
                {{ block "tweet*" . }}
                    <div
                        id="tweet-{{ .ID }}"
                        @fir:delete-tweet="$fir.removeEl()"
                        style="display: flex;margin-top:1rem;margin-bottom:1rem;">
                        <div style="margin-right:1rem">
                            Tweet:
                            {{ .Body }}
                        </div>
                        <div
                            id="like-tweet-{{ .ID }}"
                            @fir:like-tweet="$fir.replace()"
                            style="margin-right:1rem">
                            {{ block "like-tweet*" . }}
                                <div>
                                    Likes:
                                    {{ .LikesCount }}
                                </div>
                            {{ end }}
                        </div>
                        <form
                            id="update-tweet-{{ .ID }}"
                            method="post"
                            @submit.prevent="$fir.submit()"
                            style="margin-right:1rem">
                            <input
                                type="hidden"
                                name="tweetID"
                                value="{{ .ID }}" />
                            <button
                                formaction="/?event=like-tweet"
                                type="submit">
                                Like
                            </button>
                            <button
                                formaction="/?event=delete-tweet"
                                type="submit">
                                Delete
                            </button>
                        </form>
                    </div>
                {{ end }}
            {{ end }}
        </div>
    </div>
{{ end }}
